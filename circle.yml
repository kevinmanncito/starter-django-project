## Customize the test machine
machine:

  timezone:
    America/Denver

  # Version of ruby to use
  python:
    version:
      2.7.5

  # Override /etc/hosts
  # hosts:
  #   circlehost: 127.0.0.1
  #   dev.mycompany.com: 127.0.0.1

  # Add some environment variables
  environment:
    LK_ENV: test
    DATABASE_URL: postgres://ubuntu:@127.0.0.1:5432/circle_test
    POSTGRES_ADDR: 127.0.0.1
    POSTGRES_PORT: 5432

## Customize dependencies
dependencies:
  pre:
    - pip install -r misc/requirements.txt

## Customize database setup
# database:
  # override:
    # replace CircleCI's generated database.yml
    # - cp config/database.yml.ci config/database.yml
    # - psql -U ubuntu circle_test < my-database-setup.sql
    # - bundle exec rake db:create db:schema:load

test:
  override:
    - coverage run manage.py test
  post:
    - coverage html -d $CIRCLE_ARTIFACTS

## Customize deployment commands
# deployment:
#   staging:
#     branch: master
#     heroku:
#       appname: foo-bar-123

deployment:
  production:
    branch: master
    commands:
      - ./deploy-to-production.sh
  staging:
    branch: staging
    commands:
      - ./deploy-to-staging.sh

## Custom notifications
# notify:
#   webhooks:
#     # A list of hashes representing hooks. Only the url field is supported.
#     - url: https://someurl.com/hooks/circle